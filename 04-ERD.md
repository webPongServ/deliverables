~~~
-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.
-- USER Table Create SQL
-- 테이블 생성 SQL - USER
CREATE TABLE USER
(
    USERID            varchar(50)    NOT NULL,
    TWOFACTOR         boolean        NOT NULL,
    TWOFACTOR_DATA    varchar(50)    NULL,
    STATUS            integer        NOT NULL,
     PRIMARY KEY (USERID)
);
-- 테이블 Comment 설정 SQL - USER
COMMENT ON TABLE USER IS ‘USER’;
-- 컬럼 Comment 설정 SQL - USER.USERID
COMMENT ON COLUMN USER.USERID IS ‘USERID’;
-- 컬럼 Comment 설정 SQL - USER.TWOFACTOR
COMMENT ON COLUMN USER.TWOFACTOR IS ‘TWOFACTOR’;
-- 컬럼 Comment 설정 SQL - USER.TWOFACTOR_DATA
COMMENT ON COLUMN USER.TWOFACTOR_DATA IS ‘TWOFACTOR_DATA’;
-- 컬럼 Comment 설정 SQL - USER.STATUS
COMMENT ON COLUMN USER.STATUS IS ‘STATUS’;
-- FRIEND Table Create SQL
-- 테이블 생성 SQL - FRIEND
CREATE TABLE FRIEND
(
    USERID      varchar(50)    NOT NULL,
    FRIENDID    varchar(50)    NOT NULL,
    STATUS      boolean        NOT NULL,
     PRIMARY KEY (USERID, FRIENDID)
);
-- 테이블 Comment 설정 SQL - FRIEND
COMMENT ON TABLE FRIEND IS ‘FRIEND’;
-- 컬럼 Comment 설정 SQL - FRIEND.USERID
COMMENT ON COLUMN FRIEND.USERID IS ‘USERID’;
-- 컬럼 Comment 설정 SQL - FRIEND.FRIENDID
COMMENT ON COLUMN FRIEND.FRIENDID IS ‘FRIENDID’;
-- 컬럼 Comment 설정 SQL - FRIEND.STATUS
COMMENT ON COLUMN FRIEND.STATUS IS ‘STATUS’;
-- Foreign Key 설정 SQL - FRIEND(USERID) -> USER(USERID)
ALTER TABLE FRIEND
    ADD CONSTRAINT FK_FRIEND_USERID_USER_USERID FOREIGN KEY (USERID)
        REFERENCES USER (USERID) ON DELETE RESTRICT ON UPDATE RESTRICT;
-- Foreign Key 삭제 SQL - FRIEND(USERID)
-- ALTER TABLE FRIEND
-- DROP CONSTRAINT FK_FRIEND_USERID_USER_USERID;
-- GAMEHISTORY Table Create SQL
-- 테이블 생성 SQL - GAMEHISTORY
CREATE TABLE GAMEHISTORY
(
    USERID     varchar(50)    NOT NULL,
    OPPSEID    varchar(50)    NOT NULL,
    WIN        boolean        NULL,
    GAMEID     integer        GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    STATUS     boolean        NOT NULL,
     PRIMARY KEY (USERID, GAMEID)
);
-- 테이블 Comment 설정 SQL - GAMEHISTORY
COMMENT ON TABLE GAMEHISTORY IS ‘GAMEHISTORY’;
-- 컬럼 Comment 설정 SQL - GAMEHISTORY.USERID
COMMENT ON COLUMN GAMEHISTORY.USERID IS ‘USERID’;
-- 컬럼 Comment 설정 SQL - GAMEHISTORY.OPPSEID
COMMENT ON COLUMN GAMEHISTORY.OPPSEID IS ‘OPPOSEID’;
-- 컬럼 Comment 설정 SQL - GAMEHISTORY.WIN
COMMENT ON COLUMN GAMEHISTORY.WIN IS ‘WIN’;
-- 컬럼 Comment 설정 SQL - GAMEHISTORY.GAMEID
COMMENT ON COLUMN GAMEHISTORY.GAMEID IS ‘GAMEID’;
-- 컬럼 Comment 설정 SQL - GAMEHISTORY.STATUS
COMMENT ON COLUMN GAMEHISTORY.STATUS IS ‘STATUS’;
-- Foreign Key 설정 SQL - GAMEHISTORY(USERID) -> USER(USERID)
ALTER TABLE GAMEHISTORY
    ADD CONSTRAINT FK_GAMEHISTORY_USERID_USER_USERID FOREIGN KEY (USERID)
        REFERENCES USER (USERID) ON DELETE RESTRICT ON UPDATE RESTRICT;
-- Foreign Key 삭제 SQL - GAMEHISTORY(USERID)
-- ALTER TABLE GAMEHISTORY
-- DROP CONSTRAINT FK_GAMEHISTORY_USERID_USER_USERID;
-- BLACKLIST Table Create SQL
-- 테이블 생성 SQL - BLACKLIST
CREATE TABLE BLACKLIST
(
    USERID     varchar(50)    NOT NULL,
    OPPSEID    varchar(50)    NOT NULL,
    STATUS     boolean        NOT NULL,
     PRIMARY KEY (USERID, OPPSEID)
);
-- 테이블 Comment 설정 SQL - BLACKLIST
COMMENT ON TABLE BLACKLIST IS ‘BLACKLIST’;
-- 컬럼 Comment 설정 SQL - BLACKLIST.USERID
COMMENT ON COLUMN BLACKLIST.USERID IS ‘USERID’;
-- 컬럼 Comment 설정 SQL - BLACKLIST.OPPSEID
COMMENT ON COLUMN BLACKLIST.OPPSEID IS ‘OPPOSEID’;
-- 컬럼 Comment 설정 SQL - BLACKLIST.STATUS
COMMENT ON COLUMN BLACKLIST.STATUS IS ‘STATUS’;
-- Foreign Key 설정 SQL - BLACKLIST(USERID) -> USER(USERID)
ALTER TABLE BLACKLIST
    ADD CONSTRAINT FK_BLACKLIST_USERID_USER_USERID FOREIGN KEY (USERID)
        REFERENCES USER (USERID) ON DELETE RESTRICT ON UPDATE RESTRICT;
-- Foreign Key 삭제 SQL - BLACKLIST(USERID)
-- ALTER TABLE BLACKLIST
-- DROP CONSTRAINT FK_BLACKLIST_USERID_USER_USERID;
-- ACHIVEMENT Table Create SQL
-- 테이블 생성 SQL - ACHIVEMENT
CREATE TABLE ACHIVEMENT
(
    NAME    varchar(50)    NULL,
    RULE    integer        NULL,
     PRIMARY KEY (NAME)
);
-- 테이블 Comment 설정 SQL - ACHIVEMENT
COMMENT ON TABLE ACHIVEMENT IS ‘ACHIVEMENT’;
-- 컬럼 Comment 설정 SQL - ACHIVEMENT.NAME
COMMENT ON COLUMN ACHIVEMENT.NAME IS ‘ACHIVEMENT_NAME’;
-- 컬럼 Comment 설정 SQL - ACHIVEMENT.RULE
COMMENT ON COLUMN ACHIVEMENT.RULE IS ‘ACHIVE_RULE’;
~~~





## 기능 컴포넌트

| No.  | 대기능 | 소기능 | 소기능 명  |
| ---- | ------ | ------ | ---------- |
| 1    | WPS    | UA     | user agent |
| 2    | WPS    | CH     | channel    |
| 3    | WPS    | GM     | game       |
| 4    | WPS    | CM     | common     |





## 테이블명 format



- prefix
  - TB : 테이블 (object 구분)

- middle
  - "소기능" + "sequence 번호"
    - UA01 : user agent table
    - CH01 : channel table
    - GM01 : game table
    - CM01 : common table

- postfix
  - M : 기본
  - L : 내역
  - D : 상세
  - S : 통계
  - H : 이력



IV_UA01m



## 테이블 목록

| No   | table id | table name       | comment |      |
| ---- | -------- | ---------------- | ------- | ---- |
| 1    | TB_UA01M | 유저기본         |         |      |
|      | TB_UA02L | 유저친구내역     |         |      |
|      | TB_CH00L | 채팅차단내역     |         |      |
|      | TB_CM01M | 코드기본         |         |      |
|      | TB_CM01D | 코드상세         |         |      |
|      |          |                  |         |      |
|      | TB_CH01L | 채팅방내역       |         |      |
|      | TB_CH02L | 채팅방참가자내역 |         |      |
|      | TB_CH03D | 채팅방제약상세   |         |      |
|      | TB_CH04L | 채팅방메시지내역 |         |      |
|      |          |                  |         |      |





## 테이블 내용



- TB_UA01M

|      | key  | colunm id      | column name            | null     | data type   | domain                 | comment          | default  |
| ---- | ---- | -------------- | ---------------------- | -------- | ----------- | ---------------------- | ---------------- | -------- |
| 1    | k    | INTRA_ID       | 42intra id             | not null |             |                        |                  |          |
|      | u    |                | 닉네임                 | not null |             | 1~8 글자(숫자영문한글) |                  | intra id |
|      |      | TWOFACTOR      |                        | not null | boolean     |                        | 42intra 검증컬럼 |          |
|      |      | TWOFACTOR_DATA |                        |          | varchar(50) |                        | 42intra 검증컬럼 |          |
|      |      | status         |                        |          |             |                        |                  |          |
|      |      |                |                        |          |             |                        |                  |          |
|      |      | FRST_IN_DTTM   | 최초 입력 연월일시분초 | not null | date        |                        |                  |          |
|      |      | LAST_IN_DTTM   | 최종 입력 연월일시분초 | not null | date        |                        |                  |          |







- TB_UA02L

|      | key  | colunm id   | column name     | null     | data type | domain | comment | default |
| ---- | ---- | ----------- | --------------- | -------- | --------- | ------ | ------- | ------- |
| 1    | K, F | INTRA_ID    | 42intra id      | not null |           |        |         |         |
|      | K    | FR_INTRA_ID | 친구 42intra id | not null |           |        |         |         |
|      |      | ST_CD       | 상태코드        | not null |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |





- TB_CM01M

|      | key  | colunm id   | column name     | null     | data type | domain | comment | default |
| ---- | ---- | ----------- | --------------- | -------- | --------- | ------ | ------- | ------- |
| 1    | K, F | INTRA_ID    | 42intra id      | not null |           |        |         |         |
|      | K    | FR_INTRA_ID | 친구 42intra id | not null |           |        |         |         |
|      |      | ST_CD       | 상태코드        |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |



- TB_CM01D

|      | key  | colunm id   | column name     | null     | data type | domain | comment | default |
| ---- | ---- | ----------- | --------------- | -------- | --------- | ------ | ------- | ------- |
| 1    | K, F | INTRA_ID    | 42intra id      | not null |           |        |         |         |
|      | K    | FR_INTRA_ID | 친구 42intra id | not null |           |        |         |         |
|      |      | ST_CD       | 상태코드        |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |
|      |      |             |                 |          |           |        |         |         |



- TB_CH01L

|      | key  | colunm id     | column name      | null     | data type   | domain | comment                    | default |
| ---- | ---- | ------------- | ---------------- | -------- | ----------- | ------ | -------------------------- | ------- |
| 1    | k    | CHNN_ID       | channel id       | not null | Number      |        |                            |         |
|      |      | CHNN_NAME     | channel name     | not null | varchar(50) |        |                            |         |
|      |      | CHNN_TYPE     | channel type     | not null | Enum        |        | Public, protected, private |         |
|      |      | MAXIMUM       | Maximum people   | not null | Number      |        |                            |         |
|      |      | PASSWORD      | channel password | Null     | varchar(50) |        |                            |         |
|      |      | EXISTENCE     | existence        | not null | Boolean     |        | 채팅방 존재 유무           |         |
|      |      | CREAT_IN_DTTM | creation time    | not null | date        |        |                            |         |



- TB_CH02L

|      | key  | colunm id     | column name | null     | data type | domain | comment                               | default |
| ---- | ---- | ------------- | ----------- | -------- | --------- | ------ | ------------------------------------- | ------- |
| 1    | k    | CHNN_ID       | channel id  | not null | Number    |        |                                       |         |
|      | k    | USER_ID       | user id     | not null | number    |        |                                       |         |
|      |      | AUTHORITY     | authority   | not null | Enum      |        | Owner, Administrator, Normal(, slave) |         |
|      |      | EXISTENCE     | existence   | not null | Boolean   |        |                                       |         |
|      |      | ENTRY_IN_DTTM | entry time  | not null | date      |        |                                       |         |
|      |      | CHNGE_IN_DTTM | change time | not null | date      |        |                                       |         |



- TB_CH03D

|      | key  | colunm id     | column name   | null     | data type | domain | comment   | default |
| ---- | ---- | ------------- | ------------- | -------- | --------- | ------ | --------- | ------- |
| 1    | k    | CHNN_ID       | channel id    | not null | Number    |        |           |         |
|      | k    | USER_ID       | user id       | not null | number    |        |           |         |
|      | k    | RESTRICTION   | restriction   | not null | Enum      |        | Mute, Ban |         |
|      |      | VALID         | Valid         | not null | Boolean   |        |           |         |
|      |      | CREAT_IN_DTTM | creation time | not null | date      |        |           |         |
|      |      | CHNGE_IN_DTTM | change time   | not null | date      |        |           |         |



- TB_CH04L

|      | key  | colunm id     | column name   | null     | data type    | domain | comment           | default |
| ---- | ---- | ------------- | ------------- | -------- | ------------ | ------ | ----------------- | ------- |
| 1    | k    | CHNN_ID       | channel id    | not null | Number       |        |                   |         |
|      | k    | USER_ID       | user id       | not null | number       |        |                   |         |
|      |      | MESSAGE       | Message       | not null | varchar(300) |        | 최대길이 정해야함 |         |
|      | k    | CREAT_IN_DTTM | creation time | not null | date         |        |                   |         |






